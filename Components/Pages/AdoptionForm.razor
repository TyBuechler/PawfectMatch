@page "/adopt/{dogId:int}"

@inject HttpClient Http

<h3>Adopt @dogName</h3>

<EditForm Model="@adoptionForm" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="form-group">
        <label for="fullName">Full Name:</label>
        <InputText id="fullName" class="form-control" @bind-Value="adoptionForm.FullName" required />
    </div>

    <div class="form-group">
        <label for="email">Email:</label>
        <InputText id="email" class="form-control" @bind-Value="adoptionForm.Email" required />
    </div>

    <div class="form-group">
        <label for="phone">Phone Number:</label>
        <InputText id="phone" class="form-control" @bind-Value="adoptionForm.Phone" required />
    </div>

    <div class="form-group">
        <label for="address">Address:</label>
        <InputText id="address" class="form-control" @bind-Value="adoptionForm.Address" required />
    </div>

    <div class="form-group">
        <label for="preferences">Dog Preferences (Optional):</label>
        <InputText id="preferences" class="form-control" @bind-Value="adoptionForm.Preferences" />
    </div>

    <div class="form-group">
        <label>Have you had pets before?</label>
        <select @bind="adoptionForm.HasPetsBefore" class="form-control">
            <option value="">Select</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
        </select>
    </div>

    <div class="form-group">
        <label>Do you agree to a home check?</label>
        <InputCheckbox @bind-Value="adoptionForm.HomeCheck" />
    </div>

    <div class="form-group">
        <label for="message">Message:</label>
        <InputTextArea id="message" class="form-control" @bind-Value="adoptionForm.Message" />
    </div>

    <button type="submit" class="btn btn-primary">Submit Adoption Request</button>
</EditForm>

@code {
    [Parameter] public int dogId { get; set; }
    private AdoptionFormModel adoptionForm = new AdoptionFormModel();
    private string dogName;

    protected override async Task OnInitializedAsync()
    {
        // Fetch the dog's name based on the dogId (replace this with an actual API call)
        dogName = $"Dog {dogId}";
    }

    private async Task HandleValidSubmit()
    {
        // Send the form data to the server
        var response = await Http.PostAsJsonAsync("api/adopt", adoptionForm);

        if (response.IsSuccessStatusCode)
        {
            // Handle success (maybe show a confirmation message)
        }
        else
        {
            // Handle failure (maybe show an error message)
        }
    }

    public class AdoptionFormModel
    {
        public string FullName { get; set; }
        public string Email { get; set; }
        public string Phone { get; set; }
        public string Address { get; set; }
        public string Preferences { get; set; }
        public string HasPetsBefore { get; set; }
        public bool HomeCheck { get; set; }
        public string Message { get; set; }
    }
}
